<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Functions - C3 Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Functions";
    var mkdocs_page_input_path = "functions.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ebnf.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bnf.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> C3 Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">About C3</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Installing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../setup/">Setup</a>
                </li>
                <li class="">
                    
    <a class="" href="../firstproject/">Your first project</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../changesfromc/">Changes from C</a>
                </li>
                <li class="">
                    
    <a class="" href="../examples/">Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../modules/">Modules</a>
                </li>
                <li class="">
                    
    <a class="" href="../types/">Types</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Functions</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#functions">Functions</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#regular-functions">Regular functions</a></li>
        
            <li><a class="toctree-l4" href="#member-functions">Member functions</a></li>
        
            <li><a class="toctree-l4" href="#pre-and-post-conditions">Pre and post conditions</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../statements/">Statements</a>
                </li>
                <li class="">
                    
    <a class="" href="../errorhandling/">Errors</a>
                </li>
                <li class="">
                    
    <a class="" href="../builtinmacros/">Built-in Macros</a>
                </li>
                <li class="">
                    
    <a class="" href="../precedence/">Precedence</a>
                </li>
                <li class="">
                    
    <a class="" href="../generics/">Generics</a>
                </li>
                <li class="">
                    
    <a class="" href="../preconditions/">Pre and post conditions</a>
                </li>
                <li class="">
                    
    <a class="" href="../library/">Library</a>
                </li>
                <li class="">
                    
    <a class="" href="../ideas/">Crazy ideas</a>
                </li>
                <li class="">
                    
    <a class="" href="../naming/">Naming rules</a>
                </li>
                <li class="">
                    
    <a class="" href="../syntax/">Grammar</a>
                </li>
                <li class="">
                    
    <a class="" href="../sample/">More code examples</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Build system</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../buildintro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../project/">Project Structure</a>
                </li>
                <li class="">
                    
    <a class="" href="../buildcommands/">Commands</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../contribute/">Contribute</a>
                </li>
                <li class="">
                    
    <a class="" href="../changes/">Changes</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">C3 Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation &raquo;</li>
        
      
    
    <li>Functions</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="functions">Functions</h1>
<p>C3 has both regular functions and member functions. Member functions are name spaced using a type name, and allows invocations using the dot syntax.</p>
<h2 id="regular-functions">Regular functions</h2>
<p>Regular functions looks similar to C. It starts with the keyword <code>func</code>, followed by the conventional C declaration of <code>&lt;return type&gt; &lt;name&gt;(&lt;parameter list&gt;)</code>. C3 adds a <code>throws</code> declaration, that will declare that the function might return an error instead of its usual return value.</p>
<pre><code>func void test(int times)
{
    for (int i = 0; i &lt; times; i++)
    {
        printf(&quot;Hello %d\n&quot;, i);
    }
}
</code></pre>

<h3 id="using-throws">Using throws</h3>
<p>The throws parameter may return a generic throws clause â€“ in this case the error type is unknown.</p>
<p>The below example might throw errors from both the <code>SomeError</code> error domain as well as the <code>OtherError</code> error domain.</p>
<pre><code>func int test() throws
{
    if (random_value() &gt; 0.2) throw SomeError.BAD_JOSS_ERROR;
    if (random_value() &gt; 0.5) throw OtherError.BAD_LUCK_ERROR;
    return 0;
}
</code></pre>

<p>The errors can be explicitly documented, by listing the error domains, separated by <code>,</code></p>
<pre><code>func int test() throws SomeError, OtherError
{
    if (random_value() &gt; 0.2) throw SomeError.BAD_JOSS_ERROR;
    if (random_value() &gt; 0.5) throw OtherError.BAD_LUCK_ERROR;
    return 0;
}
</code></pre>

<h2 id="member-functions">Member functions</h2>
<p>Member functions look exactly like functions, but are prefixed with the struct, union or enum name:</p>
<pre><code>type Point struct 
{
    int x;
    int y;
}

func void Point.add(Point&amp; p, int x) 
{
    p.x = x;
}

func void example() 
{
    Point p = { 1, 2 }

    // with struct-functions
    p.add(10);

    // Also callable as:
    Point.add(&amp;p, 10);
}
</code></pre>

<p>If a member function does not take the type as the first parameter, then it may only be invoked qualified with the type name:</p>
<pre><code>func Point&amp; Point.new(int x, int y) 
{
    Point &amp;p = malloc(@sizeof(Point));
    p.x = x;
    p.y = y;
    return p;
}

func void example2() 
{
    Point &amp;p = Point.new(1, 2);
}
</code></pre>

<p>Struct and unions will always take pointer, whereas enums take the enum value.</p>
<pre><code>type State enum
{
    STOPPED,
    RUNNING
}

func bool State.mayOpen(State state) 
{
    switch (state)
    {
        case State.STOPPED: return true;
        case State.RUNNING: return false;
    }
}
</code></pre>

<h3 id="restrictions-on-member-functions">Restrictions on member functions</h3>
<p>Member functions may not:</p>
<ul>
<li>Member functions on a struct/union may not have the same name as a member.</li>
<li>Member functions only works on struct, union and enum types.</li>
<li>When taking a function pointer of a member function, use the full name.</li>
<li>Using sub types, overlapping function names will be shadowed.</li>
</ul>
<h2 id="pre-and-post-conditions">Pre and post conditions</h2>
<p>C3's error handling is not intended to use errors to signal invalid data or to check invariants and post conditions. Instead C3's approach is to add annotations to the function, that conditionally will be compiled into asserts.</p>
<p>As an example, the following code:</p>
<pre><code>/**
 * @param foo : the number of foos 
 * @require foo &gt; 0, foo &lt; 1000
 * @return number of foos x 10
 * @ensure return &lt; 10000, return &gt; 0
 **/
func int testFoo(int foo)
{
    return foo * 10;
}
</code></pre>

<p>Will in debug builds be compiled into something like this:</p>
<pre><code>func int testFoo(int foo)
{
    assert(foo &gt; 0);
    assert(foo &lt; 1000);
    int _return = foo * 10;
    assert(_return &lt; 10000);
    assert(_return &gt; 0);
    return _return;
}
</code></pre>

<p>The compiler is allowed to use the pre and post conditions for optimizations. For example this:</p>
<pre><code>func int testExample(int bar)
{
    if (testFoo(bar) == 0) return -1;
    return 1;
}
</code></pre>

<p>May be optimized to:</p>
<pre><code>func int testExample(int bar)
{
    return 1;
}
</code></pre>

<p>In this case the compiler can look at the post condition of <code>result &gt; 0</code> to determine that <code>testFoo(foo) == 0</code> must always be false.</p>
<p>Looking closely at this code, we not that nothing guarantees that <code>bar</code> is not violating the preconditions. In debug builds this will usually be checked in runtime, but a sufficiently smart compiler will warn about the lack of checks on <code>bar</code>. Execution of code violating pre and post conditions has undefined behaviour.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../statements/" class="btn btn-neutral float-right" title="Statements">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../types/" class="btn btn-neutral" title="Types"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../types/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../statements/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
