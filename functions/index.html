<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Functions - C3 Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Functions";
    var mkdocs_page_input_path = "functions.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ebnf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bnf.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> C3 Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">About C3</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installing</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../setup/">Setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../firstproject/">Your first project</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../changesfromc/">Changes from C</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compare/">Comparisons with other languages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../modules/">Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../types/">Types</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../arrays/">Arrays</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Functions</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#regular-functions">Regular functions</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#function-arguments">Function arguments</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#varargs">Varargs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#functions-and-failables">Functions and failables</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#methods">Methods</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#restrictions-on-methods">Restrictions on methods</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pre-and-post-conditions">Pre and post conditions</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../statements/">Statements</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../expressions/">Expressions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../errorhandling/">Errors</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../undefinedbehaviour/">Undefined behaviour</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../conversion/">Conversions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../builtinmacros/">Built-in Macros</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../precedence/">Precedence</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../generics/">Generics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../macros/">Macros</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../reflection/">Reflection</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../preconditions/">Pre and post conditions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../library/">Library</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ideas/">Crazy ideas</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../naming/">Naming rules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../comments/">Comments & Docs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../attributes/">Attributes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cinterop/">C Interop</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../syntax/">Grammar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sample/">More code examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../specification/">Specification</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Build system</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../buildintro/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../project/">Project Structure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../buildcommands/">Commands</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contribute/">Contribute</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../changes/">Changes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rejectedideas/">Rejected ideas</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">C3 Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation &raquo;</li>
        
      
    
    <li>Functions</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="functions">Functions</h1>
<p>C3 has both regular functions and member functions. Member functions are name spaced using a type name, and allows invocations using the dot syntax.</p>
<h2 id="regular-functions">Regular functions</h2>
<p>Regular functions looks similar to C. It starts with the keyword <code>func</code>, followed by the conventional C declaration of <code>&lt;return type&gt; &lt;name&gt;(&lt;parameter list&gt;)</code>. C3 adds a <code>throws</code> declaration, that will declare that the function might return an error instead of its usual return value.</p>
<pre><code>func void test(int times)
{
    for (int i = 0; i &lt; times; i++)
    {
        printf(&quot;Hello %d\n&quot;, i);
    }
}
</code></pre>

<h3 id="function-arguments">Function arguments</h3>
<p>C3 allows use of default arguments as well as named arguments.</p>
<pre><code>func int testWithDefault(int foo = 1)
{
    return foo;
}

func void test()
{
    testWithDefault();
    testWithDefault(100);
}
</code></pre>

<p>Named arguments</p>
<pre><code>func void testNamed(int times, double data)
{
    for (int i = 0; i &lt; times; i++)
    {
        printf(&quot;Hello %d\n&quot;, i + data);
    }
}

func void test()
{
    testNamed(.data = 3.0, .times = 1)
    testNamed(3, 4.0);
}
</code></pre>

<p>Named arguments with defaults:</p>
<pre><code>func void testNamedDefault(int times = 1, double data = 3.0, bool dummy = false)
{
    for (int i = 0; i &lt; times; i++)
    {
        printf(&quot;Hello %d\n&quot;, i + data);
    }
}

func void test()
{
    testNamed(.data = 3.0)

    // Mixing named and defaults:
    testNamed(3, .dummy = false);

    // Mixing named and defaults leaving out initial values:
    testNamed(,,false, .times = 1);
}
</code></pre>

<h4 id="varargs">Varargs</h4>
<p>There are two types of varargs: the usual C-style untyped varargs and typed varargs. Untyped varargs will always send arguments as-is, whereas typed arguments will do normal conversions.</p>
<pre><code>func void varargsUntyped(string foo, ...)
{
    /* ... */
}

func void varargsTyped(string bar, int... ints)
{
    /* ... */
}

func void test()
{
    varargsUntyped(&quot;Hello&quot;, 2, 1.0, cast(1 as byte), &quot;Test&quot;);
    varargsTyped(&quot;Test&quot;, 2, cast(1 as byte));
    // The second parameter will be converted to an int implicitly.
}
</code></pre>

<h3 id="functions-and-failables">Functions and failables</h3>
<p>The return parameter may be a <em>failable</em> – a type suffixed by <code>!</code> indicating that this function might either return a regular value or an error.</p>
<p>The below example might throw errors from both the <code>SomeError</code> error domain as well as the <code>OtherError</code> error domain.</p>
<pre><code>func double! testError() throws
{
    double val = random_value();_
    if (val &gt;= 0.2) return BadJossError!;
    if (val &gt; 0.5) return BadLuckError!;
    return val;
}
</code></pre>

<p><em>A function</em> that is passed a <em>failable</em> value will only conditionally execute if and only if all failable values evaluate to true, otherwise <em>the first</em> error is returned.</p>
<pre><code>func void test()
{
    // The following line is either prints a value less than 0.2
    // or does not print at all:
    printf(&quot;%d\n&quot;, testError());

    double x = (testError() + testError()) else 100;

    // This prints either a value less than 0.4 or 100:
    printf(&quot;%d\n&quot;, x);
}
</code></pre>

<p>This allows us to chain functions:</p>
<pre><code>
func void printInputWithExplicitChecks()
{
    string! line = readLine();
    if (line)
    {
        // line is a regular &quot;string&quot; here.
        int! val = atoi(line);
        if (val)
        {
            printf(&quot;You typed the number %d\n&quot;, val);
            return;
        }
    }
    printf(&quot;You didn't type an integer :(\n&quot;);    
}

func void printInputWithChaining()
{
    if (int val = atoi(readLine()))
    {
        printf(&quot;You typed the number %d\n&quot;, val);
        return;
    }
    printf(&quot;You didn't type an integer :(\n&quot;);    
}
</code></pre>

<h2 id="methods">Methods</h2>
<p>Methods look exactly like functions, but are prefixed with the struct, union or enum name and is (usually) invoked using dot syntax:</p>
<pre><code>struct Point
{
    int x;
    int y;
}

func void Point.add(Point* p, int x) 
{
    p.x = x;
}

func void example() 
{
    Point p = { 1, 2 }

    // with struct-functions
    p.add(10);

    // Also callable as:
    Point.add(&amp;p, 10);
}
</code></pre>

<p>If a method does not take the type as the first parameter, then it may only be invoked qualified with the type name:</p>
<pre><code>func Point* Point.new(int x, int y) 
{
    Point* p = malloc(@sizeof(Point));
    p.x = x;
    p.y = y;
    return p;
}

func void example2() 
{
    Point* p = Point.new(1, 2);
}
</code></pre>

<p>Struct and unions will always take pointer, whereas enums take the enum value.</p>
<pre><code>enum State
{
    STOPPED,
    RUNNING
}

func bool State.mayOpen(State state) 
{
    switch (state)
    {
        case State.STOPPED: return true;
        case State.RUNNING: return false;
    }
}
</code></pre>

<h3 id="restrictions-on-methods">Restrictions on methods</h3>
<ul>
<li>Methods on a struct/union may not have the same name as a member.</li>
<li>Methods only works on distinct, struct, union and enum types.</li>
<li>When taking a function pointer of a method, use the full name.</li>
<li>Using sub types, overlapping function names will be shadowed.</li>
</ul>
<h2 id="pre-and-post-conditions">Pre and post conditions</h2>
<p>C3's error handling is not intended to use errors to signal invalid data or to check invariants and post conditions. Instead C3's approach is to add annotations to the function, that conditionally will be compiled into asserts.</p>
<p>As an example, the following code:</p>
<pre><code>/**
 * @param foo : the number of foos 
 * @require foo &gt; 0, foo &lt; 1000
 * @return number of foos x 10
 * @ensure return &lt; 10000, return &gt; 0
 **/
func int testFoo(int foo)
{
    return foo * 10;
}
</code></pre>

<p>Will in debug builds be compiled into something like this:</p>
<pre><code>func int testFoo(int foo)
{
    assert(foo &gt; 0);
    assert(foo &lt; 1000);
    int _return = foo * 10;
    assert(_return &lt; 10000);
    assert(_return &gt; 0);
    return _return;
}
</code></pre>

<p>The compiler is allowed to use the pre and post conditions for optimizations. For example this:</p>
<pre><code>func int testExample(int bar)
{
    if (testFoo(bar) == 0) return -1;
    return 1;
}
</code></pre>

<p>May be optimized to:</p>
<pre><code>func int testExample(int bar)
{
    return 1;
}
</code></pre>

<p>In this case the compiler can look at the post condition of <code>result &gt; 0</code> to determine that <code>testFoo(foo) == 0</code> must always be false.</p>
<p>Looking closely at this code, we not that nothing guarantees that <code>bar</code> is not violating the preconditions. In debug builds this will usually be checked in runtime, but a sufficiently smart compiler will warn about the lack of checks on <code>bar</code>. Execution of code violating pre and post conditions has undefined behaviour.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../statements/" class="btn btn-neutral float-right" title="Statements">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../arrays/" class="btn btn-neutral" title="Arrays"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../arrays/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../statements/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
